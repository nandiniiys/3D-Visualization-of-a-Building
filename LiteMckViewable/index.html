<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>3D Visualization of a building</title>
	<style>
		#myNavCubeCanvas {
			position: absolute;
			width: 250px;
			height: 250px;
			bottom: 50px;
			right: 10px;
			z-index: 200000;
		}
		#myCanvas {
			width: 100%;
			height: 100%;
			background: black;
		}

		body {
			background-color:#000;
			overflow: hidden !important;
		}

		#title {
			color: white;
			font-size: 2em;
		}

		#summary {
			color: white;
			font-size: 1em;
			display: inline;
		}

		#arrow-right {
			color: #DC143C;
			font-size: 1.2em;
			display: inline;
		}

		.tooltip {
			color: white;
			position: relative;
			display: inline-block;
			font-size: 1.5em;
			border-bottom: 5px double #800080;
			border-top: 5px double #4169E1;
			border-left: 5px double #C71585;
			border-right: 5px double #20B2AA;
		}

		.tooltip .tooltiptext {
			visibility: hidden;
			width: 350px;
			background-color: #555;
			color: white;
			text-align: center;
			border-radius: 6px;
			padding: 5px 0;
			position: absolute;
			z-index: 1;
			bottom: 125%;
			left: 50%;
			margin-left: -60px;
			opacity: 0;
			transition: opacity 0.3s;
		}

		.tooltip .tooltiptext::after {
			content: "";
			position: absolute;
			top: 100%;
			left: 50%;
			margin-left: -5px;
			border-width: 5px;
			border-style: solid;
			border-color: #555 transparent transparent transparent;
		}

		.tooltip:hover .tooltiptext {
			visibility: visible;
			opacity: 1;
		}

	</style>

</head>

<body>
<div id="Project Information">
	<h1 id="title">3D Visualization of a building</h1>
	<h1 id="summary">
		<p>
			This 3D interactive model was generated by running the 2D to 3D building transformation pipeline <br>
			 on the floorplans of our dataset:
		</p>
	</h1>
</div>
<br>
<div class="tooltip">2D data to 3D data
<span class="tooltiptext">Used Autodesk Revit to create 3D floorplans as IFC files from the 2D blueprints.</span>
</div>

&emsp;
<h1 id="arrow-right"> --------> </h1>
&emsp;

<div class="tooltip">IFC to XKT & JSON
<span class="tooltiptext">Converted the IFC files to Xeokit's proprietary XKT file format and extracted metadata as JSON files.</span>
</div>

&emsp;
<h1 id="arrow-right"> --------> </h1>
&emsp;
<div class="tooltip">Load the models in browser
<span class="tooltiptext">Ran a Python script that combines Xeokit SDK's functionality to load the 3D models, and HTML, Javascript and ThreeJS to create this webpage.</span>
</div>

<canvas id="myCanvas" width="256" height="650"></canvas>
<canvas id="myNavCubeCanvas"></canvas>
</body>

<script src="https://threejs.org/examples/js/libs/dat.gui.min.js" type="text/javascript"></script>
<script>
	window.onload = function() {
controller = {
// console.log("controller");
"Project Paper" : function() {
	window.open('https://github.com/nandiniiys/3D-Visualization-of-a-Building/blob/main/3D_buildingVisualization.pdf')
},
"Github Project Repo" : function() {
	window.open('https://github.com/nandiniiys/3D-Visualization-of-a-Building/')
},
"Nandinii Github" : function() {
	window.open('https://github.com/nandiniiys/')
},
"Daniel Website" : function() {
	window.open('https://danielhaehn.com')
},
"Loraine Github" : function() {
	window.open('https://github.com/lorifranke')
}
};
		 //console.log("before");
var gui = new dat.GUI();
var info = gui.addFolder('Project Information');
info.add(controller, 'Project Paper');
info.add(controller, 'Github Project Repo');
info.add(controller, 'Nandinii Github');
info.add(controller, 'Daniel Website');
info.add(controller, 'Loraine Github');
info.open()

//console.log("after");
animate()
	};
</script>

<script type="module">

	//------------------------------------------------------------------------------------------------------------------
	// Import needed modules to load XKT models
	//------------------------------------------------------------------------------------------------------------------

	import {Viewer} from "./src/viewer/Viewer.js";
	import {XKTLoaderPlugin} from "./src/plugins/XKTLoaderPlugin/XKTLoaderPlugin.js";
		import {NavCubePlugin} from "./src/plugins/NavCubePlugin/NavCubePlugin.js";


	//------------------------------------------------------------------------------------------------------------------
	// Create a Viewer and the arrange the camera positioning
	//------------------------------------------------------------------------------------------------------------------

	const viewer = new Viewer({
		canvasId: "myCanvas",
		transparent: true
	});

	viewer.scene.camera.eye = [10.45, 17.38, -98.31];
	viewer.scene.camera.look = [43.09, 0.5, -26.76];
	viewer.scene.camera.up = [0.06, 0.96, 0.16];

	viewer.scene.selectedMaterial.fillAlpha = 0.1;

	new NavCubePlugin(viewer, {
		canvasId: "myNavCubeCanvas",
		visible: true,
		size: 250,
		alignment: "bottomRight",
		bottomMargin: 100,
		rightMargin: 10
	});

	//----------------------------------------------------------------------------------------------------------------------
	// Create an XKT loader plugin using the viewer we created earlier
	//----------------------------------------------------------------------------------------------------------------------

	const xktLoader = new XKTLoaderPlugin(viewer);

	//------------------------------------------------------------------------------------------------------------------
	// Mouse over entities to highlight them
	//------------------------------------------------------------------------------------------------------------------

	var lastEntity = null;

	viewer.scene.input.on("mousemove", function (coords) {

		var hit = viewer.scene.pick({
			canvasPos: coords
		});

		if (hit) {

			if (!lastEntity || hit.entity.id !== lastEntity.id) {

				if (lastEntity) {
					lastEntity.highlighted = false;
				}

				lastEntity = hit.entity;
				hit.entity.highlighted = true;
			}
		} else {

			if (lastEntity) {
				lastEntity.highlighted = false;
				lastEntity = null;
			}
		}
	});


//Use the xktLoader to load data on all teh floors in the building.
	const Mck1 = xktLoader.load({
		id: "myModel1",
		src: "./models/Mck1.xkt",
		metaModelSrc: "./models/Mck1.json",
		position: [0, 0, 0],
		edges: true
	});
	const Mck2 = xktLoader.load({
		id: "myModel2",
		src: "./models/Mck2.xkt",
		metaModelSrc: "./models/Mck2.json",
		position: [-0.3, 6, -6.65],
		edges: true
	});
	const Mck3 = xktLoader.load({
		id: "myModel3",
		src: "./models/Mck3.xkt",
		metaModelSrc: "./models/Mck3.json",
		position: [-14, 12, 9.35],
		edges: true
	});
	const Mck4 = xktLoader.load({
		id: "myModel4",
		src: "./models/Mck4.xkt",
		metaModelSrc: "./models/Mck4.json",
		position: [-14, 18, 1],
		edges: true
	});
</script>
</html>